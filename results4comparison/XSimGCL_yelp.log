================================================================================
   SELFRec: A library for self-supervised recommendation.   
================================================================================
Available Models
--------------------------------------------------------------------------------
Graph-Based Baseline Models:
   LightGCN   DirectAU   MF
--------------------------------------------------------------------------------
Self-Supervised Graph-Based Models:
   SGL   SimGCL   SEPT   MHCN   BUIR   SelfCF   SSL4Rec   XSimGCL   NCL   MixGCF
--------------------------------------------------------------------------------
Sequential Baseline Models:
   SASRec
--------------------------------------------------------------------------------
Self-Supervised Sequential Models:
   CL4SRec   BERT4Rec
--------------------------------------------------------------------------------
Reading data and preprocessing...
Model: XSimGCL
Training Set: /home/csc0411/repo/DNA_longtails/SELFRec_github/dataset/myyelp/train.txt
Test Set: /home/csc0411/repo/DNA_longtails/SELFRec_github/dataset/myyelp/test.txt
Embedding Dimension: 64
Maximum Epoch: 100
Learning Rate: 0.001
Batch Size: 2048
Regularization Parameter: 0.0001
Specific parameters: n_layer:2  l_star:1  lambda:0.1  eps:0.5  tau:0.15
Training Set Size: (user number: 29601, item number: 24734, interaction number: 1069128)
Test Set Size: (user number: 29530, item number: 24679, interaction number: 305466)
================================================================================
Initializing and building model...
Training Model...
training: 1 batch 100 rec_loss: 0.5839290022850037 cl_loss 0.4882863163948059
training: 1 batch 200 rec_loss: 0.5503278374671936 cl_loss 0.47217321395874023
training: 1 batch 300 rec_loss: 0.5139526128768921 cl_loss 0.4719216525554657
training: 1 batch 400 rec_loss: 0.46560731530189514 cl_loss 0.4799529016017914
training: 1 batch 500 rec_loss: 0.42456042766571045 cl_loss 0.48391103744506836
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 1, Hit Ratio: 0.08484, Precision: 0.04388, Recall: 0.09064, NDCG: 0.07865
*Best Performance*
Epoch: 1, Hit Ratio: 0.08484, Precision: 0.04388, Recall: 0.09064, NDCG: 0.07865
--------------------------------------------------------------------------------
training: 2 batch 100 rec_loss: 0.36637571454048157 cl_loss 0.500246524810791
training: 2 batch 200 rec_loss: 0.32285159826278687 cl_loss 0.5078097581863403
training: 2 batch 300 rec_loss: 0.2833399772644043 cl_loss 0.5130637288093567
training: 2 batch 400 rec_loss: 0.2579403519630432 cl_loss 0.5091290473937988
training: 2 batch 500 rec_loss: 0.23492611944675446 cl_loss 0.5081078410148621
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 2, Hit Ratio: 0.08734, Precision: 0.04517, Recall: 0.09374, NDCG: 0.08106
*Best Performance*
Epoch: 2, Hit Ratio: 0.08734, Precision: 0.04517, Recall: 0.09374, NDCG: 0.08106
--------------------------------------------------------------------------------
training: 3 batch 100 rec_loss: 0.2063921093940735 cl_loss 0.49638333916664124
training: 3 batch 200 rec_loss: 0.1910606473684311 cl_loss 0.49152788519859314
training: 3 batch 300 rec_loss: 0.1910117268562317 cl_loss 0.4849185049533844
training: 3 batch 400 rec_loss: 0.17838945984840393 cl_loss 0.4770822525024414
training: 3 batch 500 rec_loss: 0.17374876141548157 cl_loss 0.4725278913974762
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 3, Hit Ratio: 0.09123, Precision: 0.04718, Recall: 0.09818, NDCG: 0.0849
*Best Performance*
Epoch: 3, Hit Ratio: 0.09123, Precision: 0.04718, Recall: 0.09818, NDCG: 0.0849
--------------------------------------------------------------------------------
training: 4 batch 100 rec_loss: 0.15874983370304108 cl_loss 0.46455106139183044
training: 4 batch 200 rec_loss: 0.14887648820877075 cl_loss 0.45846518874168396
training: 4 batch 300 rec_loss: 0.15352748334407806 cl_loss 0.4530320167541504
training: 4 batch 400 rec_loss: 0.15131087601184845 cl_loss 0.4498906135559082
training: 4 batch 500 rec_loss: 0.14154823124408722 cl_loss 0.4450545310974121
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 4, Hit Ratio: 0.09423, Precision: 0.04874, Recall: 0.10195, NDCG: 0.08775
*Best Performance*
Epoch: 4, Hit Ratio: 0.09423, Precision: 0.04874, Recall: 0.10195, NDCG: 0.08775
--------------------------------------------------------------------------------
training: 5 batch 100 rec_loss: 0.1317588835954666 cl_loss 0.43887200951576233
training: 5 batch 200 rec_loss: 0.1365470439195633 cl_loss 0.4353652000427246
training: 5 batch 300 rec_loss: 0.13199466466903687 cl_loss 0.43116170167922974
training: 5 batch 400 rec_loss: 0.13183683156967163 cl_loss 0.42690616846084595
training: 5 batch 500 rec_loss: 0.12327095866203308 cl_loss 0.424453467130661
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 5, Hit Ratio: 0.09593, Precision: 0.04961, Recall: 0.10374, NDCG: 0.08943
*Best Performance*
Epoch: 5, Hit Ratio: 0.09593, Precision: 0.04961, Recall: 0.10374, NDCG: 0.08943
--------------------------------------------------------------------------------
training: 6 batch 100 rec_loss: 0.12320360541343689 cl_loss 0.42045900225639343
training: 6 batch 200 rec_loss: 0.11807126551866531 cl_loss 0.4181556701660156
training: 6 batch 300 rec_loss: 0.10947109758853912 cl_loss 0.4134724736213684
training: 6 batch 400 rec_loss: 0.11818382889032364 cl_loss 0.412564754486084
training: 6 batch 500 rec_loss: 0.11733268201351166 cl_loss 0.4099518954753876
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 6, Hit Ratio: 0.09739, Precision: 0.05037, Recall: 0.10558, NDCG: 0.09089
*Best Performance*
Epoch: 6, Hit Ratio: 0.09739, Precision: 0.05037, Recall: 0.10558, NDCG: 0.09089
--------------------------------------------------------------------------------
training: 7 batch 100 rec_loss: 0.11163011938333511 cl_loss 0.4047374725341797
training: 7 batch 200 rec_loss: 0.11090211570262909 cl_loss 0.4048770070075989
training: 7 batch 300 rec_loss: 0.10866320133209229 cl_loss 0.40160757303237915
training: 7 batch 400 rec_loss: 0.1093888208270073 cl_loss 0.39962178468704224
training: 7 batch 500 rec_loss: 0.10569537431001663 cl_loss 0.3978767991065979
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 7, Hit Ratio: 0.09848, Precision: 0.05093, Recall: 0.1067, NDCG: 0.09181
*Best Performance*
Epoch: 7, Hit Ratio: 0.09848, Precision: 0.05093, Recall: 0.1067, NDCG: 0.09181
--------------------------------------------------------------------------------
training: 8 batch 100 rec_loss: 0.10295505076646805 cl_loss 0.39480090141296387
training: 8 batch 200 rec_loss: 0.0988173633813858 cl_loss 0.39358100295066833
training: 8 batch 300 rec_loss: 0.10187835991382599 cl_loss 0.393343448638916
training: 8 batch 400 rec_loss: 0.09521137177944183 cl_loss 0.38994285464286804
training: 8 batch 500 rec_loss: 0.0968727394938469 cl_loss 0.38829758763313293
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 8, Hit Ratio: 0.09897, Precision: 0.05119, Recall: 0.1072, NDCG: 0.09246
*Best Performance*
Epoch: 8, Hit Ratio: 0.09897, Precision: 0.05119, Recall: 0.1072, NDCG: 0.09246
--------------------------------------------------------------------------------
training: 9 batch 100 rec_loss: 0.10100489854812622 cl_loss 0.38624319434165955
training: 9 batch 200 rec_loss: 0.09429620206356049 cl_loss 0.3850923180580139
training: 9 batch 300 rec_loss: 0.09414224326610565 cl_loss 0.3816778063774109
training: 9 batch 400 rec_loss: 0.08707525581121445 cl_loss 0.3824191391468048
training: 9 batch 500 rec_loss: 0.0883522555232048 cl_loss 0.381193071603775
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 9, Hit Ratio: 0.09932, Precision: 0.05137, Recall: 0.10747, NDCG: 0.0928
*Best Performance*
Epoch: 9, Hit Ratio: 0.09932, Precision: 0.05137, Recall: 0.10747, NDCG: 0.0928
--------------------------------------------------------------------------------
training: 10 batch 100 rec_loss: 0.09765920042991638 cl_loss 0.37978944182395935
training: 10 batch 200 rec_loss: 0.08139394223690033 cl_loss 0.37664541602134705
training: 10 batch 300 rec_loss: 0.08203715085983276 cl_loss 0.3780299723148346
training: 10 batch 400 rec_loss: 0.08881683647632599 cl_loss 0.37553706765174866
training: 10 batch 500 rec_loss: 0.0870736688375473 cl_loss 0.3744804263114929
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 10, Hit Ratio: 0.09958, Precision: 0.0515, Recall: 0.10764, NDCG: 0.09311
*Best Performance*
Epoch: 10, Hit Ratio: 0.09958, Precision: 0.0515, Recall: 0.10764, NDCG: 0.09311
--------------------------------------------------------------------------------
training: 11 batch 100 rec_loss: 0.0869072824716568 cl_loss 0.3729202151298523
training: 11 batch 200 rec_loss: 0.08289619535207748 cl_loss 0.37325814366340637
training: 11 batch 300 rec_loss: 0.09037666767835617 cl_loss 0.3727148175239563
training: 11 batch 400 rec_loss: 0.08706257492303848 cl_loss 0.3706039488315582
training: 11 batch 500 rec_loss: 0.0758473351597786 cl_loss 0.3698093891143799
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 11, Hit Ratio: 0.0998, Precision: 0.05162, Recall: 0.108, NDCG: 0.09341
*Best Performance*
Epoch: 11, Hit Ratio: 0.0998, Precision: 0.05162, Recall: 0.108, NDCG: 0.09341
--------------------------------------------------------------------------------
training: 12 batch 100 rec_loss: 0.08040335774421692 cl_loss 0.36848655343055725
training: 12 batch 200 rec_loss: 0.08730579912662506 cl_loss 0.367413192987442
training: 12 batch 300 rec_loss: 0.07382838428020477 cl_loss 0.36659929156303406
training: 12 batch 400 rec_loss: 0.08346985280513763 cl_loss 0.3651222884654999
training: 12 batch 500 rec_loss: 0.07821518182754517 cl_loss 0.36456313729286194
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 12, Hit Ratio: 0.10007, Precision: 0.05176, Recall: 0.10829, NDCG: 0.09362
*Best Performance*
Epoch: 12, Hit Ratio: 0.10007, Precision: 0.05176, Recall: 0.10829, NDCG: 0.09362
--------------------------------------------------------------------------------
training: 13 batch 100 rec_loss: 0.08130586892366409 cl_loss 0.3652152121067047
training: 13 batch 200 rec_loss: 0.08144150674343109 cl_loss 0.3631095290184021
training: 13 batch 300 rec_loss: 0.07920762896537781 cl_loss 0.3628232181072235
training: 13 batch 400 rec_loss: 0.08418318629264832 cl_loss 0.36156007647514343
training: 13 batch 500 rec_loss: 0.08623411506414413 cl_loss 0.36215740442276
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 13, Hit Ratio: 0.10031, Precision: 0.05188, Recall: 0.10851, NDCG: 0.0938
*Best Performance*
Epoch: 13, Hit Ratio: 0.10031, Precision: 0.05188, Recall: 0.10851, NDCG: 0.0938
--------------------------------------------------------------------------------
training: 14 batch 100 rec_loss: 0.07979798316955566 cl_loss 0.3611023426055908
training: 14 batch 200 rec_loss: 0.07484707981348038 cl_loss 0.3607430160045624
training: 14 batch 300 rec_loss: 0.07065308839082718 cl_loss 0.35916823148727417
training: 14 batch 400 rec_loss: 0.06903967261314392 cl_loss 0.35864242911338806
training: 14 batch 500 rec_loss: 0.08019442856311798 cl_loss 0.3572261929512024
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 14, Hit Ratio: 0.1005, Precision: 0.05198, Recall: 0.10873, NDCG: 0.09388
*Best Performance*
Epoch: 14, Hit Ratio: 0.1005, Precision: 0.05198, Recall: 0.10873, NDCG: 0.09388
--------------------------------------------------------------------------------
training: 15 batch 100 rec_loss: 0.07762320339679718 cl_loss 0.3574879765510559
training: 15 batch 200 rec_loss: 0.07223480939865112 cl_loss 0.3571721613407135
training: 15 batch 300 rec_loss: 0.07377065718173981 cl_loss 0.35588034987449646
training: 15 batch 400 rec_loss: 0.06939956545829773 cl_loss 0.35596197843551636
training: 15 batch 500 rec_loss: 0.0670776516199112 cl_loss 0.3548799157142639
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 15, Hit Ratio: 0.1005, Precision: 0.05198, Recall: 0.10877, NDCG: 0.0939
*Best Performance*
Epoch: 15, Hit Ratio: 0.1005, Precision: 0.05198, Recall: 0.10877, NDCG: 0.0939
--------------------------------------------------------------------------------
training: 16 batch 100 rec_loss: 0.06345224380493164 cl_loss 0.35482898354530334
training: 16 batch 200 rec_loss: 0.06811836361885071 cl_loss 0.35320472717285156
training: 16 batch 300 rec_loss: 0.06935780495405197 cl_loss 0.3542247712612152
training: 16 batch 400 rec_loss: 0.07489851862192154 cl_loss 0.3540273904800415
training: 16 batch 500 rec_loss: 0.07313995808362961 cl_loss 0.35248395800590515
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 16, Hit Ratio: 0.10041, Precision: 0.05193, Recall: 0.10872, NDCG: 0.09391
*Best Performance*
Epoch: 15, Hit Ratio: 0.1005, Precision: 0.05198, Recall: 0.10877, NDCG: 0.0939
--------------------------------------------------------------------------------
training: 17 batch 100 rec_loss: 0.07020430266857147 cl_loss 0.35120725631713867
training: 17 batch 200 rec_loss: 0.06732717901468277 cl_loss 0.35215386748313904
training: 17 batch 300 rec_loss: 0.06416751444339752 cl_loss 0.3517484664916992
training: 17 batch 400 rec_loss: 0.06290025264024734 cl_loss 0.3511722981929779
training: 17 batch 500 rec_loss: 0.06583745032548904 cl_loss 0.3501932919025421
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 17, Hit Ratio: 0.1003, Precision: 0.05188, Recall: 0.10861, NDCG: 0.09387
*Best Performance*
Epoch: 15, Hit Ratio: 0.1005, Precision: 0.05198, Recall: 0.10877, NDCG: 0.0939
--------------------------------------------------------------------------------
training: 18 batch 100 rec_loss: 0.0616728812456131 cl_loss 0.34983545541763306
training: 18 batch 200 rec_loss: 0.07791565358638763 cl_loss 0.34997880458831787
training: 18 batch 300 rec_loss: 0.05514289811253548 cl_loss 0.348426878452301
training: 18 batch 400 rec_loss: 0.06549516320228577 cl_loss 0.34828445315361023
training: 18 batch 500 rec_loss: 0.058002375066280365 cl_loss 0.3482579290866852
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 18, Hit Ratio: 0.10022, Precision: 0.05183, Recall: 0.10853, NDCG: 0.09374
*Best Performance*
Epoch: 15, Hit Ratio: 0.1005, Precision: 0.05198, Recall: 0.10877, NDCG: 0.0939
--------------------------------------------------------------------------------
training: 19 batch 100 rec_loss: 0.0625501424074173 cl_loss 0.3470251262187958
training: 19 batch 200 rec_loss: 0.05982392281293869 cl_loss 0.34738394618034363
training: 19 batch 300 rec_loss: 0.07021497189998627 cl_loss 0.34677132964134216
training: 19 batch 400 rec_loss: 0.06424121558666229 cl_loss 0.3454822599887848
training: 19 batch 500 rec_loss: 0.06647287309169769 cl_loss 0.34614744782447815
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 19, Hit Ratio: 0.10035, Precision: 0.0519, Recall: 0.1086, NDCG: 0.09381
*Best Performance*
Epoch: 15, Hit Ratio: 0.1005, Precision: 0.05198, Recall: 0.10877, NDCG: 0.0939
--------------------------------------------------------------------------------
training: 20 batch 100 rec_loss: 0.06266903132200241 cl_loss 0.34583374857902527
training: 20 batch 200 rec_loss: 0.06032214313745499 cl_loss 0.34513577818870544
training: 20 batch 300 rec_loss: 0.0583399273455143 cl_loss 0.3450166881084442
training: 20 batch 400 rec_loss: 0.0630553662776947 cl_loss 0.3446534276008606
training: 20 batch 500 rec_loss: 0.061208344995975494 cl_loss 0.34344467520713806
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 20, Hit Ratio: 0.10013, Precision: 0.05179, Recall: 0.10832, NDCG: 0.09364
*Best Performance*
Epoch: 15, Hit Ratio: 0.1005, Precision: 0.05198, Recall: 0.10877, NDCG: 0.0939
--------------------------------------------------------------------------------
training: 21 batch 100 rec_loss: 0.06808021664619446 cl_loss 0.3445260524749756
training: 21 batch 200 rec_loss: 0.05859968811273575 cl_loss 0.34237805008888245
training: 21 batch 300 rec_loss: 0.06543250381946564 cl_loss 0.3424564301967621
training: 21 batch 400 rec_loss: 0.05474283546209335 cl_loss 0.3428225517272949
training: 21 batch 500 rec_loss: 0.05682137608528137 cl_loss 0.34356722235679626
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 21, Hit Ratio: 0.10006, Precision: 0.05175, Recall: 0.10828, NDCG: 0.09351
*Best Performance*
Epoch: 15, Hit Ratio: 0.1005, Precision: 0.05198, Recall: 0.10877, NDCG: 0.0939
--------------------------------------------------------------------------------
training: 22 batch 100 rec_loss: 0.061084575951099396 cl_loss 0.34112122654914856
training: 22 batch 200 rec_loss: 0.05325397476553917 cl_loss 0.342022567987442
training: 22 batch 300 rec_loss: 0.05255527421832085 cl_loss 0.3404786288738251
training: 22 batch 400 rec_loss: 0.06048714742064476 cl_loss 0.3410690128803253
training: 22 batch 500 rec_loss: 0.05585133284330368 cl_loss 0.3413971960544586
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 22, Hit Ratio: 0.10002, Precision: 0.05173, Recall: 0.10818, NDCG: 0.09344
*Best Performance*
Epoch: 15, Hit Ratio: 0.1005, Precision: 0.05198, Recall: 0.10877, NDCG: 0.0939
--------------------------------------------------------------------------------
training: 23 batch 100 rec_loss: 0.0485418364405632 cl_loss 0.3403811454772949
training: 23 batch 200 rec_loss: 0.05956253409385681 cl_loss 0.34028682112693787
training: 23 batch 300 rec_loss: 0.06277274340391159 cl_loss 0.3395248055458069
training: 23 batch 400 rec_loss: 0.04988318681716919 cl_loss 0.339636892080307
training: 23 batch 500 rec_loss: 0.0498889684677124 cl_loss 0.33985793590545654
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 23, Hit Ratio: 0.09991, Precision: 0.05167, Recall: 0.10793, NDCG: 0.0933
*Best Performance*
Epoch: 15, Hit Ratio: 0.1005, Precision: 0.05198, Recall: 0.10877, NDCG: 0.0939
--------------------------------------------------------------------------------
training: 24 batch 100 rec_loss: 0.05214754492044449 cl_loss 0.3385750353336334
training: 24 batch 200 rec_loss: 0.05365873873233795 cl_loss 0.33927345275878906
training: 24 batch 300 rec_loss: 0.06454405933618546 cl_loss 0.33904433250427246
training: 24 batch 400 rec_loss: 0.06113918125629425 cl_loss 0.33766722679138184
training: 24 batch 500 rec_loss: 0.05648424103856087 cl_loss 0.3378467261791229
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
--------------------------------------------------------------------------------
Real-Time Ranking Performance (Top-20 Item Recommendation)
*Current Performance*
Epoch: 24, Hit Ratio: 0.0997, Precision: 0.05156, Recall: 0.1077, NDCG: 0.09307
*Best Performance*
Epoch: 15, Hit Ratio: 0.1005, Precision: 0.05198, Recall: 0.10877, NDCG: 0.0939
--------------------------------------------------------------------------------
training: 25 batch 100 rec_loss: 0.046904634684324265 cl_loss 0.33710619807243347
training: 25 batch 200 rec_loss: 0.04995827376842499 cl_loss 0.3372843265533447
training: 25 batch 300 rec_loss: 0.048214346170425415 cl_loss 0.33663487434387207
training: 25 batch 400 rec_loss: 0.054646119475364685 cl_loss 0.33742114901542664
training: 25 batch 500 rec_loss: 0.05014025792479515 cl_loss 0.3359922170639038
Evaluating the model...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
================================================================================
Early stopping triggered! No improvement for 10 evaluations.
Best Performance achieved at epoch 15
================================================================================
Testing...
Progress: [                                                  ]0%Progress: [+                                                 ]2%Progress: [+++                                               ]6%Progress: [+++++                                             ]10%Progress: [++++++                                            ]12%Progress: [++++++++                                          ]16%Progress: [++++++++++                                        ]20%Progress: [+++++++++++                                       ]22%Progress: [+++++++++++++                                     ]26%Progress: [+++++++++++++++                                   ]30%Progress: [++++++++++++++++                                  ]32%Progress: [++++++++++++++++++                                ]36%Progress: [++++++++++++++++++++                              ]40%Progress: [++++++++++++++++++++++                            ]44%Progress: [+++++++++++++++++++++++                           ]46%Progress: [+++++++++++++++++++++++++                         ]50%Progress: [+++++++++++++++++++++++++++                       ]54%Progress: [++++++++++++++++++++++++++++                      ]56%Progress: [++++++++++++++++++++++++++++++                    ]60%Progress: [++++++++++++++++++++++++++++++++                  ]64%Progress: [+++++++++++++++++++++++++++++++++                 ]66%Progress: [+++++++++++++++++++++++++++++++++++               ]70%Progress: [+++++++++++++++++++++++++++++++++++++             ]74%Progress: [++++++++++++++++++++++++++++++++++++++            ]76%Progress: [++++++++++++++++++++++++++++++++++++++++          ]80%Progress: [++++++++++++++++++++++++++++++++++++++++++        ]84%Progress: [++++++++++++++++++++++++++++++++++++++++++++      ]88%Progress: [+++++++++++++++++++++++++++++++++++++++++++++     ]90%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++   ]94%Progress: [+++++++++++++++++++++++++++++++++++++++++++++++++ ]98%Progress: [++++++++++++++++++++++++++++++++++++++++++++++++++]100%
Evaluating...
The result has been output to  /home/csc0411/repo/DNA_longtails/SELFRec_github/results .
The result of XSimGCL:
Top 10
Hit Ratio:0.06073
Precision:0.06282
Recall:0.06686
NDCG:0.08127
Top 20
Hit Ratio:0.1005
Precision:0.05198
Recall:0.10877
NDCG:0.0939

Running time: 765.29 s
